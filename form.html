<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    @keyframes click-wave {
        0% {
            position: relative;
            width: 30px;
            height: 30px;
            opacity: 0.35;
        }

        100% {
            width: 200px;
            height: 200px;
            margin-top: -80px;
            margin-left: -80px;
            opacity: 0;
        }
    }

    .cp_ipradio .option-input {
        position: relative;
        position: relative;
        top: 5.5px;
        right: 0;
        bottom: 0;
        left: 0;
        width: 20px;
        height: 20px;
        margin-right: 0.5rem;
        cursor: pointer;
        transition: all 0.15s ease-out 0s;
        color: #ffffff;
        border: none;
        outline: none;
        background: #cdeaec;
        -webkit-appearance: none;
        appearance: none;
    }

    .cp_ipradio .option-input:hover {
        background: #cdeaec;
    }

    .cp_ipradio .option-input:checked {
        background: #84edff;
    }

    .cp_ipradio .option-input:checked::before {
        font-size: 20px;
        line-height: 30px;
        position: absolute;
        display: inline-block;
        width: 20px;
        height: 20px;
        content: '';
        text-align: center;
    }

    .cp_ipradio .option-input:checked::after {
        position: relative;
        display: block;
        content: '';
        -webkit-animation: click-wave 0.65s;
        animation: click-wave 0.65s;
        background: #84edff;
    }

    .cp_ipradio .option-input.radio {
        border-radius: 50%;
    }

    .cp_ipradio .option-input.radio::after {
        border-radius: 50%;
    }

    .cp_ipradio label {
        line-height: 40px;
        display: block;
    }

    .cp_ipradio .option-input:disabled {
        cursor: not-allowed;
        background: #b8b7b7;
    }

    .cp_ipradio .option-input:disabled::before {
        font-size: 20px;
        line-height: 30px;
        position: absolute;
        display: inline-block;
        width: 30px;
        height: 30px;
        content: '✖︎';
        text-align: center;
    }

    .cp_ipradio .disabled {
        color: #9e9e9e;
    }

    .content_div {
        width: 100%;
        display: flex;
        justify-content: center;
    }

    body {
        color: white;
        background-color: #333333;
    }

    .error_all {
        z-index: 1;
    position: absolute;
    background-color: #eb1742;
    display: block;
    height: 60%;
    width: 80%;
    top: 20%;
    left: 10%;
    border-radius: 10px;
    display: flex;
    flex-wrap: wrap;
    }

    .div_L {
        width: 20%;

    }

    .div_M {
        width: 80%;

    }

    .div_R {
        width: 20%;

    }

    .h1_text {
        font-family: 'Fredoka One', cursive;
        color: white;
    }

    .h3_text {
        border-bottom: 1px solid #BFE0D6;
    }

    @media screen {

        .h3_text {
            border-bottom: 1px solid #BFE0D6;
            margin-bottom: 70px;
        }

        .cp_ipradio {
            /*width: 90%;*/
            /*margin: 2em auto;*/
            text-align: left;
            margin-bottom: 70px;
        }

        .input_name {
            height: 25px;
            width: 100%;
            background-color: rgb(198, 255, 245);
            margin-bottom: 50px;
        }
    }

    @media handheld {

        .h3_text {
            border-bottom: 1px solid #BFE0D6;
            margin-bottom: 20%;
        }

        .cp_ipradio {
            /*width: 90%;*/
            /*margin: 2em auto;*/
            text-align: left;
            margin-bottom: 15%;
        }

        .input_name {
            height: 25px;
            width: 100%;
            background-color: rgb(198, 255, 245);
            margin-bottom: 15%;
        }
    }

    .error_text {
        /*text-align: center;
        margin-top: 50%;*/
    }


    .num_text {
        text-align: left;
        margin: 0;
        text-wrap: nowrap;
        margin-right: 10px;
    }

    .name_text {
        text-align: left;
        margin: 0;
        text-wrap: nowrap;
        margin-right: 10px;
    }

    .any_text {
        margin: 0;
        background-color: red;
        border-radius: 1rem;
        color: white;
        text-align: center;
        text-wrap: nowrap;
        padding: 0 10px;
    }

    .any_text2 {
        margin: 0;
        background-color: red;
        border-radius: 1rem;
        color: white;
        text-align: center;
        text-wrap: nowrap;
        padding: 0 10px;
        display: none;
    }


    .name1_div {
        display: flex;
        margin-bottom: 5px;
    }

    .name_label {
        /*margin-bottom: 5%;*/
        color: #ffffff;
    }

    .form_btn {
        margin-top: 5%;
    }

    .batsu {
        display: flex;
    position: relative;
    width: 100%;
    height: 30px;
    justify-content: flex-end;
    }

    .batsu::before,
    .batsu::after {
        /* 共通設定 */
        content: "";
        position: absolute;
        top: 90%;
        right: 20px;
        width: 5px;
        /* 棒の幅（太さ） */
        height: 30px;
        /* 棒の高さ */
        background:white;
    }

    .batsu::before {
        transform: translate(-50%, -50%) rotate(45deg);
    }

    .batsu::after {
        transform: translate(-50%, -50%) rotate(-45deg);
    }

    .error_text_div {
        width: 100%;
    height: 70%;
    display: flex;
    justify-content: center;
    align-items: center;
    }
</style>


<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">

<body>
    <div id="error_all" class="error_all" onclick="off_error_div()">
        <span class="batsu"></span>
        <div class="error_text_div">
        <h3 class="error_text">入力内容に誤りがあります</h3>
    </div>
    </div>
    <div class="content_div">
        <!--<div class="div_L"></div>-->

        <div class="div_M">
            <center>
                <h1 class="h1_text">Cyber Hockey</h1>

                <h3 class="h3_text">予約フォーム</h3>

                <form action="" method="get" id="form">
                    <div style="display: flex;">
                        <p class="num_text">予約人数を選択</p>
                        <p class="any_text">必須</p>
                    </div>


                    <div class="cp_ipradio">

                        <label>
                            <input type="radio" class="option-input radio" name="num" value="1人"
                                onclick="toggleRequired(false);">1人
                        </label>

                        <label>
                            <input type="radio" class="option-input radio" name="num" value="2人"
                                onclick="toggleRequired(true);">2人
                        </label>

                        <input type="radio" name="num" value="blank" checked="checked" style="display:none;" />
                    </div>



                    <!--<div class="cp_ipradio">-->

                    <label class="name_label">
                        <div class="name1_div">
                            <p class="name_text">名前1を入力してください </p>
                            <p id="name1_any" class="any_text">必須</p>
                        </div>
                        <input type="text" name="name1" id="name1" class="input_name" required>

                    </label>


                    <label>
                        <div class="name1_div">
                            <p class="name_text">名前2を入力してください </p>
                            <p id="name2_any" class="any_text2">必須</p>
                        </div>
                        <input type="text" name="name2" id="name2" class="input_name">
                    </label>


                    <label>
                        <input type="submit" class="form_btn" value="送信する">
                    </label>

                </form>
            </center>
        </div>

        <!--<div class="div_R"></div>-->
    </div>

    <script>
        function on_error_div() {
            document.getElementById('error_all').style.display = 'block';
        }

        function off_error_div() {
            console.log("error");
            document.getElementById('error_all').style.display = 'none';
        }

        /*function limitTextLength(inputElement, maxLength) {
            inputElement.addEventListener('input', function() {
                if (inputElement.value.length > maxLength) {
                    inputElement.value = inputElement.value.slice(0, maxLength);
                }
            });
        }*/

        function limitTextLength(inputElement, maxLength) {
            console.log("kita");
            if (inputElement.value.length > maxLength) {
                inputElement.value = inputElement.value.slice(0, maxLength);
            }
        }

        // 使用例
        var textarea = document.getElementById('name1'); // 制限したいテキストエリアの要素を取得
        var maxLength = 5; // 最大文字数を設定
        //limitTextLength(textarea, maxLength); // 関数を呼び出して制限を適用

        textarea.addEventListener('input', limitTextLength(textarea, maxLength));



        // ここの読解
        function toggleRequired(flg) {
            const name2 = document.getElementById('name2');
            name2.required = flg;

            const name2_any = document.getElementById('name2_any');
            // 必須の表示、非表示
            if (flg) {
                // 表示処理
                name2_any.style.display = 'block';
            } else {
                // 非表示処理
                name2_any.style.display = 'none';
            }
        }

        toggleRequired(false)

        document.getElementById("form").addEventListener("submit", function (e) {

            e.preventDefault(); // フォームの通常の送信を防ぐ
            var form = document.getElementById("form");
            var num = form.querySelector('input[name="num"]:checked').value;
            // 予約人数選択してない場合
            if (num == "blank") {
                alert("予約人数を選択してください");
                on_error_div();
                return;
            }

            var name1 = form.querySelector('input[name="name1"]').value;
            var name2 = form.querySelector('input[name="name2"]').value;

            // 文字数がオーバーしている場合
            if (name1.length > 6) {
                console.log("文字1");
                on_error_div();
            }else if (name2.length > 6) {
                console.log("文字2");
                on_error_div();
            }

            // ひらがな以外の場合
            const regex1 = /^[\u3040-\u309F]+$/;
            if (!(regex1.test(name1))) {
                console.log("ひらがな1");
                on_error_div();
            }else if (!(regex1.test(name2))) {
                console.log("ひらがな2");
                on_error_div();
            }

            // カスタムURLを構築
            var customURL = "https://script.google.com/macros/s/AKfycbyVV385u615ejA3R9ZGCX5-6XLjhT-uPwl4q8QwVgo/dev?" +
                "form=" + num + "," + encodeURIComponent(name1) + "," + encodeURIComponent(name2);

            // リダイレクト
            window.location.href = customURL;
        });

    </script>
</body>

</html>
</body>

</html>