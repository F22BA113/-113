<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ブラックジャック</title>
    <style>
        /*CPU側のcss*/
        #cpu_layer {
            text-align: right;
        }

        #cpu {
            height: 200px;
            width: 300;
            text-align: right;
        }

        .card_no1_cpu {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 0;
        }

        .card_no2_cpu {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 1;
            left: -10%;
        }

        .card_no3_cpu {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 2;
            left: -20%;
        }

        .card_no4_cpu {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 3;
            left: -30%;
        }

        .card_no5_cpu {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 4;
            left: -40%;
        }

        .card_no6_cpu {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 5;
            left: -50%;
        }

        .card_back {
            height: 200px;
            width: 136px;
        }

        #card_sum_cpu {
            height: 50px;
            width: 50px;
            font-size: large;
            text-align: center;
        }

        /*プレイヤー側のcss*/
        #mokuzi {
            text-align: center;
        }

        #data_div {
            margin-bottom: 30px;
        }

        #game_count {
            font-size: 20px;
            font-weight: 800;
        }

        #bet {
            text-align: right;
        }

        /*.card_no_ply {
            height: 200px;
            width: 136px;
        }*/

        /*#bet_momey {
            
        }*/
        #card_sum_ply {
            height: 50px;
            width: 50px;
            font-size: large;
            text-align: center;
        }

        #card_sum_ply2 {
            height: 50px;
            width: 50px;
            font-size: large;
            text-align: center;
        }

        .img_tip {
            width: 10%;
            height: 10%;
        }

        /*プレイヤー側トランプcss*/
        /*すぷりってぃんぐ一枚目のディブ*/
        .splitting_ply_on {
            background-color: antiquewhite;
            padding-top: 1px solid black;
            padding-left: 1px solid black;
            padding-bottom: 1px solid black;
            padding-right: 1px solid black;
        }

        /*すぷりってぃんぐ二枚目のディブ*/
        .splitting_ply_of {
            background-color: rgba(140, 140, 140, 0.556);
        }

        .card_no1_ply {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 0;
        }

        .card_no2_ply {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 1;
            left: -10%;
        }

        .card_no3_ply {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 2;
            left: -20%;
        }

        .card_no4_ply {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 3;
            left: -30%;
        }

        .card_no5_ply {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 4;
            left: -40%;
        }

        .card_no6_ply {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 5;
            left: -50%;
        }

        /*スプリット二枚目用*/
        .card_no1_ply2 {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 0;
        }

        .card_no2_ply2 {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 1;
            left: -10%;
        }

        .card_no3_ply2 {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 2;
            left: -20%;
        }

        .card_no4_ply2 {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 3;
            left: -30%;
        }

        .card_no5_ply2 {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 4;
            left: -40%;
        }

        .card_no6_ply2 {
            height: 200px;
            width: 136px;
            position: relative;
            z-index: 5;
            left: -50%;
        }

        /*バーストレイヤー*/
        #bust_layer {
            background-color: blue;
            width: 60%;
            height: 20%;
            line-height: 200px;
            margin-top: -375px;
            z-index: 10;
            position: relative
        }

        #bust_strong {
            font-size: large;
            color: red;
        }

        /*win レイヤー*/
        #win_layer {
            width: 60%;
            height: 20%;
            background-color: aquamarine;
            line-height: 200px;
            margin-top: -375px;
            z-index: 10;
            position: relative
        }

        /*lose レイヤー*/
        #lose_layer {
            width: 60%;
            height: 20%;
            background-color: aquamarine;
            line-height: 200px;
            margin-top: -375px;
            z-index: 10;
            position: relative
        }

        /*equal レイヤー*/
        #equal_layer {
            width: 60%;
            height: 20%;
            background-color: rgb(128, 255, 100);
            line-height: 200px;

            margin-top: -428px;
            z-index: 10;
            position: relative
        }

        /*blackjack レイヤー*/
        #bj_layer {
            width: 60%;
            height: 20%;
            background-color: aquamarine;
            line-height: 200px;

            margin-top: -428px;
            z-index: 10;
            position: relative
        }

        /*inshrance レイヤー*/
        #inshrance_layer {
            width: 60%;
            height: 20%;
            background-color: aquamarine;
            line-height: 200px;

            margin-top: -428px;
            z-index: 10;
            position: relative
        }


        #inshrance_lose_layer_layer {
            width: 60%;
            height: 20%;
            background-color: rgb(239, 161, 248);
            line-height: 200px;

            margin-top: -428px;
            z-index: 10;
            position: relative
        }

        #inshrance_win_layer_layer {
            width: 60%;
            height: 20%;
            background-color: rgb(239, 161, 248);
            line-height: 200px;

            margin-top: -428px;
            z-index: 10;
            position: relative
        }

        #inshrance_equal_layer {
            width: 60%;
            height: 20%;
            background-color: rgb(239, 161, 248);
            line-height: 200px;

            margin-top: -428px;
            z-index: 10;
            position: relative
        }

        #surrender_layer {
            width: 60%;
            height: 20%;
            background-color: rgb(239, 161, 248);
            line-height: 200px;

            margin-top: -428px;
            z-index: 10;
            position: relative
        }

        /*スコア表示*/
        #result_layer {
            width: 100%;
            height: 100%;
            background-color: beige;
        }

        #contact-ttl {
            font-size: 40px;
            font-weight: bold;
            margin-bottom: 40px;
            /* 外側かつ下側のmarginを40pxにする*/
            text-align: center;
        }

        #text_result {
            width: 70%;
            height: 50%;
        }
    </style>
    <script>
        // クリック規則
        var CHACK_button = true;
        // チップの音
        const music_bet = new Audio('bet.mp3');
        // 失敗の音
        const music_miss = new Audio('miss.mp3');
        // めくる音
        const music_card_open = new Audio('card_open.mp3');
        // 爆発音
        const music_explosion = new Audio('explosion1.mp3');
        // ブラックジャックの時の音
        const music_blackjack = new Audio('blackjack.mp3');
        const music_crap = new Audio('crap.mp3');
        // サレンダーしたとき
        const music_surrender = new Audio('surrender.mp3');

        /* ずっと流れているBGM
        const music_always = new Audio('always.mp3');
        music_always.loop = true;
        music_always.volume = 0.2;
        music_always.play();*/

        // トランプ配列
        //var TORANP = ["d.01", "d.02", "d.03", "d.04", "d.05", "d.06", "d.07", "d.08", "d.09", "d.10", "d.11", "d.12", "d.13", "h.01", "h.02", "h.03", "h.04", "h.05", "h.06", "h.07", "h.08", "h.09", "h.10", "h.11", "h.12", "h.13", "k.01", "k.02", "k.03", "k.04", "k.05", "k.06", "k.07", "k.08", "k.09", "k.10", "k.11", "k.12", "k.13", "s.01", "s.02", "s.03", "s.04", "s.05", "s.06", "s.07", "s.08", "s.09", "s.10", "s.11", "s.12", "s.13"];
        //var TORANP = ["d.01", "d.13", "h.01", "h.13", "k.01", "k.13", "s.01", "s.13"];
        //var TORANP = ["d.01", "d.13", "h.01", "h.13", "k.01", "k.13", "s.01", "s.13"];
        var TORANP = ["d.10", "d.11", "d.12", "d.13", "h.01", "h.13", "k.01", "k.13", "s.13", "d.10", "d.11", "d.12", "d.13", "d.10", "d.11", "d.12", "h.13", "k.13", "s.01", "s.13", "d.01", "d.13", "h.01", "h.13", "k.01", "k.13", "s.01", "s.13"];

        // ゲーム数カウント
        var GAME_count = 1;

        // プレイヤー側のトランプの合計
        var CARD_sum_ply = 0;
        // ブラックジャックの可能性があるか
        var BJ_chance_ply = false;
        var BJ_chance_cpu = false;
        // エースの出現管理
        var ACE_count_ply = 0;
        var ACE_count_cpu = 0;

        // ブラックジャックしたorしてないか
        var BJ_1 = false;
        var BJ_2 = false;
        // バーストしたかしてないか
        var BUST_check1 = false;
        var BUST_check2 = false;

        // cpuのトランプ変数
        var CARD_no_cpu = 1;
        // cpuの合計数の変数
        var CARD_sum_cpu = 0;

        // インシュランス関係一覧
        // インシュランスボタンを押す
        var INSURANCE = false;
        var INSURANCE_num = 0;
        // インシュランスボタンを押させるか
        var INSURANCE_chack = false;
        var INSURANCE_splitting2 = false;

        // スプリット関係一覧
        var CARD_no_ply2 = 1
        var SPLITTING = false;
        var SPLITTING_count = 0;
        var SPLITTING_bet_money = 0;
        var SPLITTING_bj_chance = false;
        var SPLITTING_card_num = 0;
        // スプリットの時にエースでスプリットしたかどうか
        var SPLITTING_ace = false;

        // スプリットの二枚目のトランプの合計変数
        var CARD_sum_ply2 = 0;
        // スプリットの一枚目のトランプの勝敗
        var SPLITTING_battle1 = "";


        // ベット金額を数値で取得
        function get_bet_num() {
            let bet_momey = document.getElementById("bet_momey").value;
            let bet_momey_array = bet_momey.split('$');
            let bet_num = parseInt(bet_momey_array[0], 10);
            return bet_num;
        }
        // ベット金額を数値で取得
        function get_bet_num2() {
            let bet_momey = document.getElementById("bet_momey2").value;
            let bet_momey_array = bet_momey.split('$');
            let bet_num = parseInt(bet_momey_array[0], 10);
            return bet_num;
        }

        // トータル金額を数値で取得
        function get_total_num() {
            let total_momey = document.getElementById("total_momey").value;
            let total_momey_array = total_momey.split('$');
            let total_num = parseInt(total_momey_array[0], 10);
            return total_num;
        }

        // ベッドしたときに呼び出される
        function bet_money(aObject) {

            // 所持＆ベッド金額計算
            var id = aObject.id;

            // トータル金額を持ってくる
            let total_num = get_total_num();
            //　ベット金額を持ってくる
            let bet_num = get_bet_num();
            if (total_num <= 0) {
                return;
            }

            // ベッドぼたん出現させる
            document.getElementById('btn_bet').style.display = 'block';



            switch (id) {
                case "5$":
                    total_num -= 5;
                    bet_num += 5;
                    break;
                case "10$":
                    total_num -= 10;
                    bet_num += 10;
                    break;
                case "25$":
                    total_num -= 25;
                    bet_num += 25;
                    break;
                case "50$":
                    total_num -= 50;
                    bet_num += 50;
                    break;
                case "100$":
                    total_num -= 100;
                    bet_num += 100;
                    break;
                default:
                    alert("aaa");
                    break;
            }
            // トータル金額が最少ベット金額より小さいとき or 掛け金が上限を超えたときのとき 　要らない　掛け金が１０の倍数じゃないとき  || bet_num % 10 != 0 　掛け金が0のとき || bet_num == 0
            if (total_num < 0 || bet_num > 150) {
                // 失敗の音鳴らす
                music_miss.play();
                return;
            }
            // ベッドする音
            music_bet.volume = 1.0;
            music_bet.play();

            document.getElementById("total_momey").value = total_num + '$';
            document.getElementById("bet_momey").value = bet_num + '$';


        }

        // ベッドするところを消す、カード配分の開始
        function dollar_layer_close() {

            // 掛け金選択画面を消す
            document.getElementById('btn_bet').style.display = 'none';
            document.getElementById('dollar_layer').style.display = 'none';

            // カードの合計表示(cpu)
            open_card_sum_cpu();

            // カードの合計表示(ply)
            var imgID = document.getElementById('card_ply');
            imgID.style.display = 'block';
            // ぼたんの表示
            setTimeout(open_div_btn, 651);

            // カード配分の開始
            card_distribute();

        }
        function open_div_btn() {
            var imgID = document.getElementById('div_btn');
            imgID.style.display = 'block';
        }

        var CARD_no_ply = 1;
        // カードを配る
        function card_distribute() {
            // 一回ヒットしたならダブルとサレンダーとスプリットは禁止
            document.getElementById("double_btn").disabled = true;
            document.getElementById("surrender_btn").disabled = true;
            document.getElementById("splitting_btn").disabled = true;

            // 2回音を鳴らてカードを配りたい(player)
            hit();
            setTimeout(hit, 650);
            setTimeout(open_surrender_btn, 650);

            // カードの表示(cpu)
            card_open_cpu();


        }
        // 二枚配り終わったらサレンダーボタンオープン
        function open_surrender_btn() {
            document.getElementById("surrender_btn").disabled = false;
        }

        // ボタンを押させなくする
        function block_btn() {
            document.getElementById("hit_btn").disabled = true;
            document.getElementById("stand_btn").disabled = true;
            document.getElementById("double_btn").disabled = true;
            //if (INSURANCE_chack == true) {
            document.getElementById("insurance_btn").disabled = true;

            document.getElementById("surrender_btn").disabled = true;
        }
        // ボタンを押せるように
        function open_btn() {
            document.getElementById("hit_btn").disabled = false;
            document.getElementById("stand_btn").disabled = false;
            document.getElementById("double_btn").disabled = false;
            if (INSURANCE_chack == true) {
                document.getElementById("insurance_btn").disabled = false;
            }
        }


        function hit() {
            // クリック制限
            block_btn();

            // カードをオープンしたBGM
            music_card_open.play();

            // divタグの生成
            var divTag = document.getElementById("card_ply");
            var div2Tag = document.createElement("div");
            div2Tag.id = "ply_f";
            divTag.appendChild(div2Tag);

            // スプリッティングなら別の処理
            if (SPLITTING_count == 2) {
                divTag = document.getElementById("ply_f2");
                // ランダムで画像を表示する
                var random = Math.floor(Math.random() * TORANP.length);
                var card = TORANP[random];
                var card_img = card + ".png";

                let imgTag = document.createElement("img");
                imgTag.src = card_img;
                imgTag.id = "card_no" + CARD_no_ply2 + "_ply2";
                imgTag.className = "card_no" + CARD_no_ply2 + "_ply2";
                divTag.appendChild(imgTag);

                // カードの合計計算
                var name = "ply";
                card_num_colc(card_img, name);

            } else {
                divTag = document.getElementById("ply_f");
                // ランダムで画像を表示する
                var random = Math.floor(Math.random() * TORANP.length);
                var card = TORANP[random];
                var card_img = card + ".png";

                let imgTag = document.createElement("img");
                imgTag.src = card_img;
                imgTag.id = "card_no" + CARD_no_ply + "_ply";
                imgTag.className = "card_no" + CARD_no_ply + "_ply";
                divTag.appendChild(imgTag);

                // カードの合計計算
                var name = "ply";
                card_num_colc(card_img, name);
            }

            // 出たトランプを配列から削除
            TORANP.splice(random, 1);
            // スプリッティングなら別の処理
            if (SPLITTING_count == 2) {
                // カードの名前
                CARD_no_ply2 += 1;
            } else {
                // カードの名前
                CARD_no_ply += 1;
            }


        }



        // 出たカードの合計表示
        function card_num_colc(Acard_img, Aname) {
            // トランプの数字化
            var card_array_ply = Acard_img.split(".")
            var card_num_ply = card_array_ply[1];
            card_num_ply = parseInt(card_num_ply, 10);

            // CPUの時
            if (Aname == "cpu") {
                // 一枚目で絵札が来た時、ブラックジャックの可能性を付ける
                if (card_num_ply > 10 && CARD_no_cpu == 1) {
                    CARD_sum_cpu += 10;
                    BJ_chance_cpu = true;

                }
                // 一枚目にエースが来ていて、二枚目に絵札が来た場合　ブラックジャック確定演出
                else if (card_num_ply > 10 && CARD_no_cpu == 2 && CARD_sum_cpu == 11) {
                    CARD_sum_cpu += 10;
                    //二回表示するとこになりそう setTimeout(show_lose_layer, 1000);
                }
                // 絵札なら10に
                else if (card_num_ply > 10) {
                    CARD_sum_cpu += 10;

                }
                // ♠なら1or11orブラックジャックかどうかを確認
                else if (card_num_ply == 1) {
                    chack_bj_cpu(card_num_ply);

                }
                else {
                    CARD_sum_cpu += card_num_ply;
                }
                // cpuのの合計表示
                document.getElementById("card_sum_cpu").value = CARD_sum_cpu;

            }
            else if (SPLITTING_count == 2) {
                // スプリッティングPLYの時

                // 一枚目で絵札が来た時、ブラックジャックの可能性(ply)
                if (card_num_ply > 10 && CARD_no_ply2 == 1) {
                    CARD_sum_ply2 += 10;
                    BJ_chance_ply = true;
                    /*まずここ*/

                }
                // 一枚目にエースが来ていて、二枚目に絵札が来た場合　ブラックジャック確定演出
                else if (card_num_ply > 10 && CARD_no_ply2 == 2 && CARD_sum_ply2 == 11) {
                    CARD_sum_ply2 += 10;
                    BJ_2 = true;
                    // ブラックジャックレイヤーを出力
                    setTimeout(splitting_isBattleStatus, 1000);
                    // ここで終わり

                }
                // 絵札なら10に
                else if (card_num_ply > 10) {
                    CARD_sum_ply2 += 10;

                }
                // ♠なら1or11orブラックジャックかどうかを確認
                else if (card_num_ply == 1) {
                    chack_bj_ply_splitting();

                }
                else {
                    CARD_sum_ply2 += card_num_ply;
                }

                // ply2のの合計表示
                document.getElementById("card_sum_ply2").value = CARD_sum_ply2;

                // バーストしているかチェック(ply)
                var name = "SPLITTING";
                bust_check(name);
            } else {
                // 通常のPLYの時

                // 一枚目で絵札が来た時、ブラックジャックの可能性(ply)
                if (card_num_ply > 10 && CARD_no_ply == 1) {
                    CARD_sum_ply += 10;
                    BJ_chance_ply = true;

                }
                // 一枚目にエースが来ていて、二枚目に絵札が来た場合　ブラックジャック確定演出
                else if (card_num_ply > 10 && CARD_no_ply == 2 && CARD_sum_ply == 11) {
                    CARD_sum_ply += 10;
                    BJ_1 = true;
                    setTimeout(show_bj_layer, 1000);
                    /* クリック規則
                    block_btn();*/

                }
                // 絵札なら10に
                else if (card_num_ply > 10) {
                    CARD_sum_ply += 10;

                }
                // ♠なら1or11orブラックジャックかどうかを確認
                else if (card_num_ply == 1) {
                    chack_bj_ply();

                }
                else {
                    CARD_sum_ply += card_num_ply;
                }
                // スプリッティングかどうかチェック
                if (SPLITTING == false && CARD_no_ply == 2) {
                    chack_splitting();
                }

                // plyのの合計表示
                document.getElementById("card_sum_ply").value = CARD_sum_ply;

                // バーストしているかチェック(ply)
                var name = "ply";
                bust_check(name);
            }

        }


        // 1or11orブラックジャック(ply)
        function chack_bj_ply() {
            // エースが出たとこをカウント
            ACE_count_ply += 1;
            // 11が入るか確認
            CARD_sum_ply += 11;
            // ブラックジャックの時
            if (CARD_sum_ply == 21 && BJ_chance_ply == true) {
                /* クリック規則
                block_btn();*/
                BJ_1 == true;
                setTimeout(show_bj_layer, 1000);

            }// 11でバーストするなら1に
            else if (CARD_sum_ply > 21) {
                CARD_sum_ply -= 10;
                ACE_count_ply -= 1;

            }
            // バーストしなければ11を 
            else {
            }

        }
        // 1or11orブラックジャック(cpu)
        function chack_bj_cpu(Acard_num_cpu) {
            // エースが出たとこをカウント
            ACE_count_cpu += 1;
            // 11が入るか確認
            CARD_sum_cpu += 11;
            // ブラックジャックの時
            if (CARD_sum_cpu == 21 && BJ_chance_cpu == true) {
                // することなし
            }// 11でバーストするなら1に
            else if (CARD_sum_cpu > 21) {
                CARD_sum_cpu -= 10;
                ACE_count_cpu -= 1;
                // バーストしなければ11を足す
            }// 一枚目にエースが来たとき
            else if (CARD_no_cpu == 1) {
                INSURANCE_chack = true;
                document.getElementById("insurance_btn").disabled = false;
            } else {
            }

        }
        // 1or11orブラックジャック(スプリット)
        function chack_bj_ply_splitting(Acard_num_ply) {
            // エースが出たとこをカウント
            ACE_count_ply += 1;
            // 11が入るか確認
            CARD_sum_ply2 += 11;
            // ブラックジャックの時
            if (CARD_sum_ply2 == 21 && BJ_chance_ply == true) {
                /* クリック規則
                block_btn();*/
                BJ_2 == true;
                // ブラックジャックレイヤーを出力
                setTimeout(splitting_isBattleStatus, 800);
                // ここで終わり

            }// 11でバーストするなら1に
            else if (CARD_sum_ply2 > 21) {
                CARD_sum_ply2 -= 10;
                ACE_count_ply -= 1;

            }
            // バーストしなければ11を 
            else {
            }

        }

        // バーストしているかチェック
        function bust_check(Aname) {

            // 二枚目のスプリットからの呼び出しの時
            if (Aname == "SPLITTING") {
                // バーストしている時
                if (CARD_sum_ply2 > 21) {
                    // バーストしてて、♠があるとき
                    if (ACE_count_ply == 1) {
                        // ♠を11から１に変更
                        CARD_sum_ply2 -= 10;
                        ACE_count_ply -= 1;
                        // トランプの合計表示
                        document.getElementById("card_sum_ply2").value = CARD_sum_ply2;
                        // 入力規則を戻す
                        open_btn();
                    }
                    // 単純にバーストしている時
                    else {
                        BUST_check2 = true;
                        // クリック規則　要らなく根
                        block_btn();
                        // バーストレイヤーを出力
                        setTimeout(splitting_isBattleStatus, 1000);

                    }

                    // ブラックジャックの時
                } else if (CARD_sum_ply == 21 && BJ_2 == true) {
                    return;
                }
                // バーストしていないとき
                else {
                    // バーストしていなかったらボタンを元に戻す
                    open_btn();
                }
            }
            // プレイヤー側からの呼び出しの時
            else if (Aname == "ply") {
                // バーストしている時
                if (CARD_sum_ply > 21) {
                    // バーストしてて、♠があるとき
                    if (ACE_count_ply == 1) {
                        // ♠を11から１に変更
                        CARD_sum_ply -= 10;
                        ACE_count_ply -= 1;
                        // トランプの合計表示
                        document.getElementById("card_sum_ply").value = CARD_sum_ply;
                        // 入力規則を戻す
                        open_btn();
                    }
                    // 単純にバーストしている時
                    else {
                        BUST_check1 = true;
                        // クリック規則　要らなく根
                        block_btn();
                        // バーストレイヤーを出力
                        setTimeout(show_bast_layer, 1000);

                        // 場面をリセットする
                        if (SPLITTING_count == 1) {
                            setTimeout(reset_splitting_game, 3000);
                        } else {
                            setTimeout(reset_game, 3000);
                        }
                    }
                    // ブラックジャックの時
                } else if (CARD_sum_ply == 21 && BJ_1 == true) {
                    return;
                }
                // バーストしていないとき
                else {
                    // バーストしていなかったらボタンを元に戻す
                    open_btn();
                }
            }
            // cpu側からの呼び出しの時
            else if (Aname == "cpu") {
                // バーストしている時
                if (CARD_sum_cpu > 21) {
                    // バーストしてて、♠があるとき
                    if (ACE_count_cpu == 1) {
                        // バーストしてて、♠があるとき
                        if (ACE_count_cpu == 1) {
                            // ♠を11から１に変更
                            CARD_sum_cpu -= 10;
                            ACE_count_cpu -= 1;
                            // トランプの合計表示
                            document.getElementById("card_sum_cpu").value = CARD_sum_cpu;
                        }
                    }// 単純にバーストしている時
                    else {
                        // クリック規則
                        block_btn();

                    }
                }
            } else {
                // バーストしていなかったらボタンを元に戻す
                open_btn();
            }
        }
        /* バーストしてて、♠が2枚あるとき
                    else if (ACE_count_ply >= 2) {
                        // ♠の一枚目をを11から１に変更
                        CARD_sum_ply -= 10;
                        // 一枚変更してもバーストしている時
                        if (CARD_sum_ply > 21) {
                            // 二枚目も１に変更
                            CARD_sum_ply -= 10;
                        }
                        // トランプの合計表示
                        document.getElementById("card_sum_ply").value = CARD_sum_ply;

                    }*/

        // バーストレイヤーを出力
        function show_bast_layer() {
            document.getElementById("bust_layer").style.display = 'block';

            var bet_num = 0;
            out_bet_num(bet_num);
        }
        function bj_equal_layer() {

        }


        // カードの表示(cpu)
        function card_open_cpu() {

            // divタグの生成
            var divTag = document.getElementById("cpu_layer");
            var div2Tag = document.createElement("div");
            div2Tag.id = "cpu_f";
            divTag.appendChild(div2Tag);

            // カードをオープンしたBGM
            music_card_open.play();
            var divTag = document.getElementById("cpu_f");
            if (CARD_no_cpu == 1) {
                // ランダムで画像を表示する
                draw_card_cpu();

                // 裏面カードの表示
                setTimeout(back_card_open, 650);


            } else if (CARD_no_cpu == 2) {
                // 裏面に画像を表示する
                var imgTag = document.getElementById("card_back");
                var random = Math.floor(Math.random() * TORANP.length);
                var card = TORANP[random];
                var card_img = card + ".png";

                imgTag.className = "card_no" + CARD_no_cpu + "_cpu";
                imgTag.src = card_img;

                // トランプの合計計算(cpu)
                var name = "cpu";
                card_num_colc(card_img, name);
            } else {
                // ランダムで画像を表示する
                draw_card_cpu();

            }
            // 出たトランプを配列から削除
            TORANP.splice(random, 1);

            // トランプの合計表示
            document.getElementById("card_sum_cpu").value = CARD_sum_cpu;
            // トランプのclass名のための変数(cpu)
            CARD_no_cpu++;
        }
        // ランダムで画像を表示する(cpu)
        function draw_card_cpu(Achil_card_cpu) {
            var divTag = document.getElementById("cpu_f");

            var random = Math.floor(Math.random() * TORANP.length);
            var card = TORANP[random];
            var card_img = card + ".png";

            var imgTag = document.createElement("img");
            imgTag.src = card_img;
            imgTag.className = "card_no" + CARD_no_cpu + "_cpu";
            imgTag.id = "card_no" + CARD_no_cpu + "_cpu";
            divTag.appendChild(imgTag);

            // カードの合計計算
            var name = "cpu";
            card_num_colc(card_img, name);
        }
        // 裏面のカードの出力
        function back_card_open() {

            var random = Math.floor(Math.random() * TORANP.length);
            var card = TORANP[random];

            var divTag = document.getElementById("cpu_f");
            var imgTag = document.createElement("img");
            imgTag.src = "card_back.png";
            imgTag.id = "card_back";
            imgTag.className = "card_back";
            divTag.appendChild(imgTag);
            // 出たトランプを配列から削除
            TORANP.splice(random, 1);
            // カードをオープンしたBGM
            music_card_open.play()

            // ここが安心だと思った
            open_btn();
        }

        // 場面をリセットしたとき
        function reset_game() {
            // すべてののレイヤーを非表示
            document.getElementById("bust_layer").style.display = "none";
            document.getElementById("card_ply").style.display = "none";
            document.getElementById("div_btn").style.display = "none";
            document.getElementById("win_layer").style.display = "none";
            document.getElementById("equal_layer").style.display = "none";
            document.getElementById("lose_layer").style.display = "none";
            document.getElementById("bj_layer").style.display = "none";
            document.getElementById("inshrance_layer").style.display = "none";
            document.getElementById("inshrance_win_layer").style.display = "none";
            document.getElementById("inshrance_lose_layer").style.display = "none";
            document.getElementById("inshrance_equal_layer").style.display = "none";
            document.getElementById("surrender_layer").style.display = "none";
            document.getElementById("bet_momey2").style.display = "none";



            // ベット金額リセット
            document.getElementById("bet_momey").value = '0$';
            document.getElementById("bet_momey2").value = '0$';
            // トランプの合計リセット
            document.getElementById("card_sum_ply").value = "0";
            CARD_sum_ply = 0;
            // トランプの合計リセット(cpu)
            document.getElementById("card_sum_cpu").value = '0';
            CARD_sum_cpu = 0;
            // ブラックジャックチャンスリセット
            BJ_chance_ply = false;
            BJ_chance_cpu = false;
            // エースの存在リセット
            ACE_count_ply = 0;
            ACE_count_cpu = 0;


            // 全てのトランプ削除
            var card_ply = document.getElementById("ply_f");
            if (card_ply != null) {
                card_ply.remove();
            }
            var cpu_layer = document.getElementById("cpu_f");
            if (cpu_layer != null) {
                cpu_layer.remove();
            }
            var cpu_layer = document.getElementById("ply_f2");
            if (cpu_layer != null) {
                cpu_layer.remove();
            }

            // 掛け金選択画面を表示
            document.getElementById("dollar_layer").style.display = 'block';

            // トランプの変数リセット
            CARD_no_cpu = 1;
            CARD_no_ply = 1;

            // カードの合計表示を消す(cpu)
            close_card_sum_cpu();

            // クリック規則解除
            //setTimeout(open_btn,1000);
            open_btn();

            // ゲームが終わりかどうかチェック
            if (GAME_count == 1) {
                result_game();
                out_total_score();
            }
            // ゲーム数カウントして表示
            GAME_count += 1;
            document.getElementById("game_count").value = "第 " + GAME_count + "ゲーム";

            // バーストのリセット
            BUST_check1 = false;
            BUST_check2 = false;

            /*if (INSURANCE == true) {
                var insurance_btn = document.getElementById("insurance_btn");
                insurance_btn.remove();
            }*/
            //document.getElementById("insurance_btn").disabled = true;

            INSURANCE == false;
            INSURANCE_chack = false;

            // スプリット関係の初期化
            CARD_no_ply2 = 1
            SPLITTING = false;
            SPLITTING_count = 0;
            SPLITTING_bet_money = 0;
            SPLITTING_bj_chance = false;
            SPLITTING_card_num = 0;
            CARD_sum_ply2 = 0;
            SPLITTING_battle1 = "";


            // ゲームオーバー可動化の判断
            let total_num = get_total_num();
            if (total_num < 5) {
                //爆発音と、ゲームオーバーレイヤーを表示
                result_game();
                // 爆発音
                music_explosion.play()
            }

        }

        function out_total_score() {
            var total_num = get_total_num();
            document.getElementById("text_result").style.display = total_num;
        }

        function reset_splitting_game() {
            // 勝ち負け判定のレイヤーを非表示
            document.getElementById("bust_layer").style.display = "none";
            //document.getElementById("win_layer").style.display = "none";
            //document.getElementById("equal_layer").style.display = "none";
            //document.getElementById("lose_layer").style.display = "none";
            document.getElementById("bj_layer").style.display = "none";
            //document.getElementById("inshrance_layer").style.display = "none";
            //document.getElementById("inshrance_win_layer").style.display = "none";
            //document.getElementById("inshrance_lose_layer").style.display = "none";
            //document.getElementById("inshrance_equal_layer").style.display = "none";
            document.getElementById("surrender_layer").style.display = "none";

            // エースの存在リセット
            ACE_count_ply = 0;
            ACE_count_cpu = 0;

            // 二枚目に移行
            var main_divTag = document.getElementById("ply_f");
            main_divTag.className = "splitting_ply_of";
            var sub_divTag = document.getElementById("ply_f2");
            sub_divTag.className = "splitting_ply_on";

            // クリック規則解除
            open_btn();


            // インシュアランスのリセット
            INSURANCE == false;
            INSURANCE_chack = false;

            // スプリッティングのカウントを2にする
            SPLITTING_count = 2;

            // 二回目のスプリッティング用意
            if (SPLITTING_ace == true) {
                ACE_count_ply = 1;
            }

            // 一枚目で絵札が来た時、ブラックジャックの可能性(ply)
            if (SPLITTING_bj_chance == true) {
                BJ_chance_ply == true
            }

            // サレンダーボタン復活
            document.getElementById("surrender_btn").disabled = false;


        }

        // 最終スコア画面を表示(終わらせる)
        function result_game() {
            document.getElementById("ply_layer").remove();
            document.getElementById("result_layer").style.display = "block";
        }


        // 勝負がstartn and cpuのカード表示開始
        function stand() {
            if (SPLITTING_count == 1) {
                reset_splitting_game();
                return;
            }
            // クリック規則
            block_btn();
            // cpuのトランプをめくる
            card_open_cpu();

            // 17より大きくなるまで引く
            if (CARD_sum_cpu < 17) {

                setTimeout(stand, 1000);

            } else {
                if (SPLITTING_count == 2) {
                    //CARD_sum_cpu -= 10;　意味わからん
                    splitting_isBattleStatus();
                    SPLITTING_count = 1;
                } else if (SPLITTING_count == 3) {
                    return
                }
                else {
                    isBattleStatus();
                }

            }
        }

        function isBattleStatus() {
            // cpuのの合計表示
            document.getElementById("card_sum_cpu").value = CARD_sum_cpu;

            // 勝ち負け判定関数
            // スプリットの場合
            if (SPLITTING == true) {
                // スプリットの一枚目の処理
                if (SPLITTING_count == 1) {
                    // cpuのブラックジャック
                    if (CARD_sum_cpu == 21) {
                        if (INSURANCE == true) {
                            SPLITTING_battle1 = "show_inshranceWin_lose_layer";
                        } else {
                            SPLITTING_battle1 = "show_lose_layer"
                        }

                        // cpuがバーストしたとき
                    } else if (CARD_sum_cpu > 21) {
                        if (INSURANCE == true) {
                            SPLITTING_battle1 = "show_inshranceLOSE_win_layer";
                        } else {
                            SPLITTING_battle1 = "show_win_layer";
                        }

                        // 引き分け
                    } else if (CARD_sum_cpu == CARD_sum_ply) {
                        if (INSURANCE == true) {
                            SPLITTING_battle1 = "show_inshranceLOSE_equal_layer";
                        } else {
                            SPLITTING_battle1 = "show_equal_layer";
                        }

                        // cpuの勝ち
                    } else if (CARD_sum_cpu > CARD_sum_ply) {
                        if (INSURANCE == true) {
                            SPLITTING_battle1 = "show_inshranceLOSE_lose_layer";
                        } else {
                            SPLITTING_battle1 = "show_lose_layer"
                        }

                        // cpuの負け
                    } else if (CARD_sum_cpu < CARD_sum_ply) {
                        if (INSURANCE == true) {
                            SPLITTING_battle1 = "show_inshranceLOSE_win_layer";
                        } else {
                            SPLITTING_battle1 = "show_win_layer";
                        }

                    } else {
                        alert('エラー1')
                    }
                    //setTimeout(reset_splitting_game, 3000);
                }// スプリットの二枚目の処理
                else if (SPLITTING_count == 2) {

                }
            }
            // 通常通り
            else {
                // cpuのブラックジャック
                if (CARD_sum_cpu == 21) {
                    if (INSURANCE == true) {
                        setTimeout(show_inshranceWin_lose_layer, 1000);
                    } else {
                        setTimeout(show_lose_layer, 1000);
                    }

                    // cpuがバーストしたとき
                } else if (CARD_sum_cpu > 21) {
                    if (INSURANCE == true) {
                        setTimeout(show_inshranceLOSE_win_layer, 1000);
                    } else {
                        setTimeout(show_win_layer, 1000);
                    }

                    // 引き分け
                } else if (CARD_sum_cpu == CARD_sum_ply) {
                    if (INSURANCE == true) {
                        setTimeout(show_inshranceLOSE_equal_layer, 1000);
                    } else {
                        setTimeout(show_equal_layer, 1000);
                    }

                    // cpuの勝ち
                } else if (CARD_sum_cpu > CARD_sum_ply) {
                    if (INSURANCE == true) {
                        setTimeout(show_inshranceLOSE_lose_layer, 1000);
                    } else {
                        setTimeout(show_lose_layer, 1000);
                    }

                    // cpuの負け
                } else if (CARD_sum_cpu < CARD_sum_ply) {
                    if (INSURANCE == true) {
                        setTimeout(show_inshranceLOSE_win_layer, 1000);
                    } else {
                        setTimeout(show_win_layer, 1000);
                    }

                } else {
                    alert('エラー1')
                }
                CARD_sum_cpu = 0;
            }

        }


        function show_win_layer() {
            document.getElementById("win_layer").style.display = 'block';
            // 勝ち計算
            win_calc();

            // 場面をリセットする
            // スプリット二枚目以外のなら処理してok、二枚目なら上記の処理のみ
            if (SPLITTING_count != 2) {
                // 場面をリセットする
                setTimeout(reset_game, 3000);
            }
        }
        function show_lose_layer() {
            document.getElementById("lose_layer").style.display = 'block';
            // 負け計算
            lose_calc();

            // 場面をリセットする
            // スプリット二枚目以外のなら処理してok、二枚目なら上記の処理のみ
            if (SPLITTING_count != 2) {
                // 場面をリセットする
                setTimeout(reset_game, 3000);
            }

        }
        function show_equal_layer() {
            document.getElementById("equal_layer").style.display = 'block';

            // 引き分け計算
            equal_calc();
            // 場面をリセットする
            // スプリット二枚目以外のなら処理してok、二枚目なら上記の処理のみ
            if (SPLITTING_count != 2) {
                // 場面をリセットする
                setTimeout(reset_game, 3000);
            }

        }
        function show_bj_layer() {
            // ブラックジャックの時の音
            music_blackjack.play();
            music_crap.play();

            document.getElementById("bj_layer").style.display = 'block';

            if (SPLITTING_count == 1) {
                // ブラックジャック計算
                bj_calc();
                setTimeout(reset_splitting_game, 3000);
            } else {
                // ブラックジャック計算
                bj_calc();
                // 場面をリセットする
                setTimeout(reset_game, 3000);
            }

        }
        function show_inshranceWin_lose_layer() {
            document.getElementById("inshrance_layer").style.display = 'block';
            // インシュアランス計算
            inshrance_calc();
            // スプリット二枚目以外のなら処理してok、二枚目なら上記の処理のみ
            if (SPLITTING_count != 2) {
                // 場面をリセットする
                setTimeout(reset_game, 3000);
            }

        }

        function show_inshranceLOSE_win_layer() {
            document.getElementById("inshrance_win_layer").style.display = 'block';
            // インシュアランス計算
            inshranceLOSE_win_calc();
            // 場面をリセットする
            // スプリット二枚目以外のなら処理してok、二枚目なら上記の処理のみ
            if (SPLITTING_count != 2) {
                // 場面をリセットする
                setTimeout(reset_game, 3000);
            }

        }

        function show_inshranceLOSE_lose_layer() {
            document.getElementById("inshrance_lose_layer").style.display = 'block';
            // インシュアランス計算
            lose_calc();
            // 場面をリセットする
            // スプリット二枚目以外のなら処理してok、二枚目なら上記の処理のみ
            if (SPLITTING_count != 2) {
                // 場面をリセットする
                setTimeout(reset_game, 3000);
            }

        }

        function show_inshranceLOSE_equal_layer() {
            document.getElementById("inshrance_equal_layer").style.display = 'block';
            // インシュアランス計算
            inshranceLOSE_equal_calc();
            // 場面をリセットする
            // スプリット二枚目以外のなら処理してok、二枚目なら上記の処理のみ
            if (SPLITTING_count != 2) {
                // 場面をリセットする
                setTimeout(reset_game, 3000);
            }

        }
        // サレンダー（降りたとき）
        function show_surrender_layer() {
            document.getElementById("surrender_layer").style.display = 'block';
            // サレンダー計算
            surrender_calc();
            // 場面をリセットする
            // スプリット1枚目以外なら処理してok、1枚目なら別処理
            if (SPLITTING_count != 1) {
                // 場面をリセットする
                setTimeout(reset_game, 3000);
            } else {
                setTimeout(reset_splitting_game, 3000);
            }
        }


        // 勝った時の処理
        function win_calc() {
            let bet_num = get_bet_num();
            bet_num *= 2;
            let total_num = get_total_num();
            total_num += bet_num;

            document.getElementById("bet_momey").value = bet_num + '$';
            document.getElementById("total_momey").value = total_num + '$';

        }
        // 負けた時の処理
        function lose_calc() {
            /* 負けた時って引き算しなくてよくね？
            let bet_num = get_bet_num();
            let total_num = get_total_num();
            total_num -= bet_num;

            document.getElementById("bet_momey").value = bet_num + '$';
            document.getElementById("total_momey").value = total_num + '$';*/
        }
        // 引き分けの時の処理
        function equal_calc() {
            let total_num = get_total_num();

            // スプリット二枚目の時のみ別処理
            if (SPLITTING_count == 2) {
                let bet_num2 = get_bet_num2();
                total_num += bet_num2;
                bet_num2 = 0;
                document.getElementById("bet_momey2").value = bet_num2 + '$';
            } else {
                let bet_num = get_bet_num();
                total_num += bet_num;
                bet_num = 0;
                document.getElementById("bet_momey").value = bet_num + '$';
            }

            document.getElementById("total_momey").value = total_num + '$';
        }
        // ブラックジャックの時の処理
        function bj_calc() {
            let total_num = get_total_num();

            // スプリット二枚目の時のみ別処理
            if (SPLITTING_count == 2) {
                let bet_num2 = get_bet_num2();
                bet_num2 *= 2.5;
                total_num += bet_num2;
                document.getElementById("bet_momey2").value = bet_num2 + '$';
            } else {
                let bet_num = get_bet_num();
                bet_num *= 2.5;
                total_num += bet_num;
                document.getElementById("bet_momey").value = bet_num + '$';
            }
            document.getElementById("total_momey").value = total_num + '$';
        }

        // インシュランスの時の処理
        function inshrance_calc() {
            let total_num = get_total_num();

            // スプリット二枚目の時のみ別処理
            if (SPLITTING_count == 2) {
                let bet_num2 = get_bet_num2();
                bet_num2 *= 3;
                total_num += bet_num2;
                document.getElementById("bet_momey2").value = bet_num2 + '$';
            } else {
                let bet_num = get_bet_num();
                bet_num *= 3;
                total_num += bet_num;
                document.getElementById("bet_momey").value = bet_num + '$';
            }

            document.getElementById("total_momey").value = total_num + '$';
        }

        // インシュランス負けて、本選勝った時の処理
        function inshranceLOSE_win_calc() {
            let total_num = get_total_num();

            // スプリット二枚目の時のみ別処理
            if (SPLITTING_count == 2) {
                let bet_num2 = get_bet_num2();
                bet_num2 *= 4;
                total_num += bet_num2;
                document.getElementById("bet_momey2").value = bet_num2 + '$';
            } else {
                let bet_num = get_bet_num();
                bet_num *= 4;
                total_num += bet_num;
                document.getElementById("bet_momey").value = bet_num + '$';
            }

            document.getElementById("total_momey").value = total_num + '$';
        }
        /* インシュランス負けて、本選負けた時の処理
        function inshranceLOSE_win_calc() {
            let bet_num = get_bet_num();
            bet_num *= 2;
            let total_num = get_total_num();
            total_num += bet_num;

            document.getElementById("total_momey").value = total_num + '$';
        }*/

        // インシュランス負けて、本選引き分けた時の処理
        function inshranceLOSE_equal_calc() {
            let total_num = get_total_num();

            // スプリット二枚目の時のみ別処理
            if (SPLITTING_count == 2) {
                let bet_num2 = get_bet_num2();
                bet_num2 *= 2;
                total_num += bet_num2;
                document.getElementById("bet_momey2").value = bet_num2 + '$';
            } else {
                let bet_num = get_bet_num();
                bet_num *= 2;
                total_num += bet_num;
                document.getElementById("bet_momey").value = bet_num + '$';
            }

            document.getElementById("total_momey").value = total_num + '$';
        }

        // サレンダー計算
        function surrender_calc() {
            let total_num = get_total_num();

            // スプリット二枚目の時のみ別処理
            if (SPLITTING_count == 2) {
                let bet_num2 = get_bet_num2();
                bet_num2 /= 2;
                total_num += bet_num2;
                document.getElementById("bet_momey2").value = bet_num2 + '$';
            } else {
                let bet_num = get_bet_num();
                bet_num /= 2;
                total_num += bet_num;
                document.getElementById("bet_momey").value = bet_num + '$';
            }

            document.getElementById("total_momey").value = total_num + '$';
        }




        // ベット金額を表示
        function out_bet_num(Abet_momey) {
            var bet_momey_value = Abet_momey + "$";
            document.getElementById("bet_momey").value = bet_momey_value;
        }
        // トータル金額を表示
        function out_total_num(Atotal_momey) {
            var total_momey_value = Atotal_momey + "$";
            document.getElementById("total_momey").value = total_momey_value;
        }

        // ロードしたとき
        function onload() {
            document.getElementById("insurance_btn").disabled = true;
            document.getElementById("splitting_btn").disabled = true;
            document.getElementById("surrender_btn").disabled = true;

        }
        // カードの合計を出現させる(cpu)
        function open_card_sum_cpu() {
            document.getElementById("card_sum_cpu").style.visibility = "visible";
        }
        // カードの合計表示を消す(cpu)
        function close_card_sum_cpu() {
            document.getElementById("card_sum_cpu").style.visibility = "hidden";
        }

        // ダブル
        function double() {
            // クリック規則
            block_btn();
            // トータル金額
            let total_num = get_total_num();

            if (SPLITTING_count == 2) {
                // 掛け金を持ってくる
                var get_num = get_bet_num2();

                //  同額分残っていなれば× 　　要らない 掛け金が0のとき || get_num == 0
                if (get_num > total_num) {
                    // 失敗の音鳴らす
                    music_miss.play();

                    open_btn();
                    return;
                }
                // 掛け金出力
                out_bet_num(get_num);
                total_num -= get_num;
            } else {
                // 掛け金を持ってくる
                var get_num = get_bet_num();

                //  同額分残っていなれば× 　　要らない 掛け金が0のとき || get_num == 0
                if (get_num > total_num) {
                    // 失敗の音鳴らす
                    music_miss.play();

                    open_btn();
                    return;
                }
                // 掛け金出力
                out_bet_num(get_num * 2);
                total_num -= get_num;
            }

            // トータル金額出力
            out_total_num(total_num);

            // ダブル専用の動き
            double_move();
        }
        function double_move() {
            // double用のhit    
            hit();

            // バーストしていたらこの時点で終わり
            if (BUST_check1 == true) {
                return;
            } else if (BUST_check2 == true) {
                return;
            }

            // クリック規則　これで治った
            block_btn();
            // していなければ、standに続く
            setTimeout(stand, 1000);

        }

        function insurance() {
            // スプリット二枚目の時のみ別処理
            if (SPLITTING_count == 2) {
                INSURANCE_splitting2 = true;
            } else {
                INSURANCE = true;
            }
            // 押させなくさせる
            block_btn();

            if (SPLITTING_count == 2) {
                // ベットの半額を保険として掛ける
                var total_num = get_total_num();
                var bet_num = get_bet_num();
                bet_num /= 2;
                total_num -= bet_num;
            } else {
                // ベットの半額を保険として掛ける
                var total_num = get_total_num();
                var bet_num = get_bet_num2();
                bet_num /= 2;
                total_num -= bet_num;

                // 保険金額のみを表示
                out_total_num(total_num);
                out_bet_num(bet_num);
            }


            setTimeout(stand, 500);
        }

        // サレンダー
        function surrender() {
            music_surrender.play();

            block_btn();

            show_surrender_layer();
        }

        // スプリッティング出来るかどうかチェック
        function chack_splitting() {
            // 二枚目の時の呼び出し以外は拒否
            if (CARD_no_ply != 2) {
                return;
            }

            var card_array_ply1 = document.getElementById("card_no1_ply").src;
            var last_num1 = card_array_ply1.lastIndexOf("/");
            card_array_ply1 = card_array_ply1.substring(last_num1);
            var array_ply1 = card_array_ply1.split(".");
            var card_num_ply1 = array_ply1[1];
            card_num_ply1 = parseInt(card_num_ply1, 10);

            var card_array_ply2 = document.getElementById("card_no2_ply").src;
            var last_num2 = card_array_ply2.lastIndexOf("/");
            card_array_ply2 = card_array_ply2.substring(last_num2);
            var array_ply2 = card_array_ply2.split(".");
            var card_num_ply2 = array_ply2[1];
            card_num_ply2 = parseInt(card_num_ply2, 10);

            if (card_num_ply2 > 10) {
                SPLITTING_bj_chance = true;
            }

            if (card_num_ply1 > 10) {
                card_num_ply1 = 10;
            }
            if (card_num_ply2 > 10) {
                card_num_ply2 = 10;
            }

            // 一枚目と二枚目が同じだったらスプリッティングボタン押せるように
            if (card_num_ply1 == card_num_ply2) {
                document.getElementById("splitting_btn").disabled = false;
            }
        }

        /*function get_card_no1_ply() {
            var card_array_ply1 = document.getElementById("card_no1_ply").src;
            var array_ply1 = card_array_ply1.split(".");
            var card_num_ply1 = array_ply1[1];
            card_num_ply1 = parseInt(card_num_ply1, 10);
            return card_num_ply1;
        }
        function get_card_no2_ply() {
            var card_array_ply2 = document.getElementById("card_no2_ply").src
            var array_ply2 = card_array_ply2.split(".");
            var card_num_ply2 = array_ply2[1];
            card_num_ply2 = parseInt(card_num_ply2, 10);
            return card_num_ply2;
        }*/

        // カードを一つずつに分ける
        function splitting() {
            // 掛け金を持ってくる
            var get_num = get_bet_num();
            // トータル金額
            let total_num = get_total_num();
            // 同額分残っていなれば× 　　要らない 掛け金が0のとき || get_num == 0
            if (get_num > total_num) {
                // 失敗の音鳴らす
                music_miss.play();

                open_btn();
                return;
            }

            //二枚目の掛け金レイヤー表示
            document.getElementById("bet_momey2").style.display = "block";
            // ベット金額表示とトータル金額から引く
            document.getElementById("bet_momey2").value = get_num + "$";
            total_num -= get_num;
            document.getElementById("total_momey").value = total_num + '$';


            // 掛け金を記憶
            SPLITTING_bet_money = get_bet_num();

            SPLITTING_count = 1;

            // カードをオープンしたBGM
            music_card_open.play();
            // スプリッティングボタン押させなく
            document.getElementById("splitting_btn").disabled = true;
            SPLITTING = true;
            CARD_no_ply = 2;

            /*var card_array_ply1 = document.getElementById("card_no1_ply").src;
            var array_ply1 = card_array_ply1.split(".");
            var card_num_ply1 = array_ply1[1];
            card_num_ply1 = parseInt(card_num_ply1, 10);*/
            // 二枚目を消す
            var card_array_ply2 = document.getElementById("card_no2_ply").src
            var array_ply2 = card_array_ply2.split(".");
            /*var card_num_ply2 = array_ply2[1];
            card_num_ply2 = parseInt(card_num_ply2, 10);*/

            document.getElementById("card_no2_ply").remove();

            // divタグの生成
            var divTag = document.getElementById("card_ply");
            var div2Tag = document.createElement("div");
            div2Tag.id = "ply_f2";
            divTag.appendChild(div2Tag);

            // トランプの合計表示の生成
            var pTag = document.createElement("p");
            pTag.textContent = "トランプの合計";
            var inputTag = document.createElement("input");
            inputTag.id = "card_sum_ply2";
            inputTag.type = "text";

            var brTag = document.createElement("br");
            div2Tag.appendChild(pTag);
            div2Tag.appendChild(brTag);
            div2Tag.appendChild(inputTag);
            div2Tag.appendChild(brTag);

            // imgの挿入
            let imgTag = document.createElement("img");
            imgTag.src = card_array_ply2;
            imgTag.id = "card_no" + CARD_no_ply2 + "_ply2";
            imgTag.className = "card_no" + CARD_no_ply2 + "_ply2";
            div2Tag.appendChild(imgTag);

            // 扱うトランプを分かりやすくするために背景を変える
            var main_divTag = document.getElementById("ply_f");
            main_divTag.className = "splitting_ply_on";
            var sub_divTag = document.getElementById("ply_f2");
            sub_divTag.className = "splitting_ply_of";

            // トランプの合計変更
            if (CARD_sum_ply == 12) {
                SPLITTING_ace = true;
                CARD_sum_ply = 11;
                CARD_sum_ply2 = 11;
                SPLITTING_card_num = CARD_sum_ply;
                // トランプの合計表示
                document.getElementById("card_sum_ply").value = CARD_sum_ply;
                document.getElementById("card_sum_ply2").value = CARD_sum_ply2;
                ACE_count_ply = 1;
            } else {
                CARD_sum_ply /= 2;
                CARD_sum_ply2 = CARD_sum_ply;
                SPLITTING_card_num = CARD_sum_ply2;
                // トランプの合計表示
                document.getElementById("card_sum_ply").value = CARD_sum_ply;
                document.getElementById("card_sum_ply2").value = CARD_sum_ply2;
            }

            CARD_no_ply2 += 1;
        }

        // スプリット専用の判定チェッカー（二枚目
        function splitting_isBattleStatus() {
            // 二枚目でブラックジャックしていて、
            if (BJ_2 == true) {
                // 一枚目でブラックジャックorバーストしていたら自動的に終わらせてok
                if (BJ_1 == true || BUST_check1 == true) {
                    show_bj_layer();
                    return
                }// 一枚目でブラックジャックしてなければ、結果判定へ
                else if (BJ_1 == false) {
                    // ブラックジャックの時の音
                    music_blackjack.play();
                    music_crap.play();

                    document.getElementById("bj_layer").style.display = 'block';

                    // ブラックジャック計算
                    bj_calc();

                    setTimeout(move_battle_to_f1, 1900);

                    return

                }
                else {
                    alert("BJエラー")
                }
            }

            // 二枚目でバストしていて、
            if (BUST_check2 == true) {
                // 一枚目でバストしていたら自動的に終わらせてok
                if (BUST_check1 == true || BJ_1 == true) {
                    show_bast_layer();
                    // 場面をリセットする
                    setTimeout(reset_game, 3000);
                    return
                }
                // 一枚目でブラックジャックorバストしていなければ、結果判定へ
                else if (BUST_check1 == false) {
                    show_bast_layer();

                    setTimeout(move_battle_to_f1, 900);
                    return
                }
                else {
                    alert("bustエラー");
                }
            }

            // 一枚目でバストかブラックジャックしていなかったら、二つを交互に判定する
            // まず二枚目から
            // cpuのブラックジャック
            if (CARD_sum_cpu == 21) {
                if (INSURANCE_splitting2 == true) {
                    setTimeout(show_inshranceWin_lose_layer, 1000);
                } else {
                    setTimeout(show_lose_layer, 1000);
                }

                // cpuがバーストしたとき
            } else if (CARD_sum_cpu > 21) {
                if (INSURANCE_splitting2 == true) {
                    setTimeout(show_inshranceLOSE_win_layer, 1000);
                } else {
                    setTimeout(show_win_layer, 1000);
                }

                // 引き分け
            } else if (CARD_sum_cpu == CARD_sum_ply2) {
                if (INSURANCE_splitting2 == true) {
                    setTimeout(show_inshranceLOSE_equal_layer, 1000);
                } else {
                    setTimeout(show_equal_layer, 1000);
                }

                // cpuの勝ち
            } else if (CARD_sum_cpu > CARD_sum_ply2) {
                if (INSURANCE_splitting2 == true) {
                    setTimeout(show_inshranceLOSE_lose_layer, 1000);
                } else {
                    setTimeout(show_lose_layer, 1000);
                }

                // cpuの負け
            } else if (CARD_sum_cpu < CARD_sum_ply2) {
                if (INSURANCE_splitting2 == true) {
                    setTimeout(show_inshranceLOSE_win_layer, 1000);
                } else {
                    setTimeout(show_win_layer, 1000);
                }

            } else {
                alert('エラー1')
            }

            // 一枚目がブラックジャックかバーストなら一枚目判定をスキップ
            if (BJ_1 == true) {
                reset_game();
                return
            } else if (BUST_check1 == true) {
                reset_game();
                return
            }

            setTimeout(move_battle_to_f1, 900);

        }
        // 結果判定を二枚目から一枚目に飛ぶ
        function move_battle_to_f1() {
            //おそらく意味ないSPLITTING_count = 1;
            // 扱うトランプを分かりやすくするために背景を変える
            var main_divTag = document.getElementById("ply_f");
            main_divTag.className = "splitting_ply_on";
            var sub_divTag = document.getElementById("ply_f2");
            sub_divTag.className = "splitting_ply_of";


            // レイヤーの削除
            document.getElementById("bust_layer").style.display = "none";
            document.getElementById("win_layer").style.display = "none";
            document.getElementById("equal_layer").style.display = "none";
            document.getElementById("lose_layer").style.display = "none";
            document.getElementById("bj_layer").style.display = "none";
            document.getElementById("inshrance_layer").style.display = "none";
            document.getElementById("inshrance_win_layer").style.display = "none";
            document.getElementById("inshrance_lose_layer").style.display = "none";
            document.getElementById("inshrance_equal_layer").style.display = "none";
            document.getElementById("surrender_layer").style.display = "none";

            SPLITTING_count = 3;
            if (BJ_2 == true || BUST_check2 == true) {
                stand();
                // 一枚目の勝敗判定を文字列に格納
                isBattleStatus();
            }
            setTimeout(splitting_card1_isBattleStatus, 500);

        }

        // スプリット一枚目の処理
        function splitting_card1_isBattleStatus() {
            eval(SPLITTING_battle1+ "()");
            //
        }
    </script>

</head>

<body onload="onload()">
    <div id="start_layer" style="display: none;"><!--ゲームが完成してから-->
        <h1>ブラックジャック</h1>
        <button>スタート</button>
    </div>
    <div id="ply_layer">
        <div style="float: right; width: 40%;">
            <div id="cpu_layer">
                <input id="card_sum_cpu" type="text" style="visibility: hidden;" readonly>
                <img id="cpu" src="IMG_0134.jpg">
                <div id="cpu_f"></div>
            </div>
        </div>


        <div style="float: left; width: 60%;">
            <input id="game_count" type="text" value="第 1ゲーム" style="border: none; outline: none;" readonly>

            <div id="data_div" style="display:table; width:60%;" </div><!--style="display:table;"-->
                <div style="display:table-cell; width:30%;"><!--style="display:table-cell;"-->
                    <p>トータル金額</p>
                    <input id="total_momey" type="text" value="50$" readonly>
                </div>
                <div id="bet" style="display:table-cell; width:30%;">
                    <p>ベット金額</p>
                    <input id="bet_momey" type="text" value="0$" readonly>
                    <input id="bet_momey2" type="text" value="0$" style="display: none;" readonly>
                </div>
            </div>

            <div id="div_btn" style="display: none;">
                <input id="hit_btn" type="button" value="ヒット" onclick="hit()">
                <input id="stand_btn" type="button" value="スタンド" onclick="stand()">
                <input id="double_btn" type="button" value="ダブル" onclick="double()">
                <input id="insurance_btn" type="button" value="インシュランス" onclick="insurance()">
                <input id="splitting_btn" type="button" value="スプリット" onclick="splitting()">
                <input id="surrender_btn" type="button" value="サレンダー" onclick="surrender()">
            </div>

            <div id="dollar_layer" style="display: block; background-color: rgb(56, 255, 255);">

                <h3 id="mokuzi">掛け金を選択してください</h3>

                <img id="5$" src="5$.jpg" class="img_tip" onclick="bet_money(this)">
                <img id="10$" src="10$.jpg" class="img_tip" onclick="bet_money(this)">
                <img id="25$" src="25$.jpg" class="img_tip" onclick="bet_money(this)">
                <img id="50$" src="50$.jpg" class="img_tip" onclick="bet_money(this)">
                <img id="100$" src="100$.jpg" class="img_tip" onclick="bet_money(this)">

                <input id="btn_bet" type="button" value="決定" style="display: none;" onclick="dollar_layer_close()">
            </div>

            <div id="card_ply" style="display: none;">
                <div id="ply_f">
                    <p>トランプの合計</p>
                    <input id="card_sum_ply" type="text" value="0" readonly><br>

                </div>
            </div>

            <center>
                <div id="bust_layer" style="display: none;">
                    <strong id="bust_strong">Bust</strong>
                </div>

                <div id="win_layer" style="display: none;">
                    <strong id="win_strong">WIN</strong>
                </div>

                <div id="lose_layer" style="display: none;">
                    <strong id="lose_strong">LOSE</strong>
                </div>

                <div id="equal_layer" style="display: none;">
                    <strong id="equal_strong">引き分け</strong>
                </div>

                <div id="bj_layer" style="display: none;">
                    <strong id="equal_strong">ブラックジャック！</strong>
                </div>

                <div id="inshrance_layer" style="display: none;">
                    <strong id="equal_strong">保険発動！！</strong>
                </div>

                <div id="inshrance_win_layer" style="display: none;">
                    <strong id="equal_strong">インシュアランス失敗,,,だけど本選は勝利！
                    </strong>
                </div>

                <div id="inshrance_lose_layer" style="display: none;">
                    <strong id="equal_strong">インシュアランス失敗,,,本選は引き分けだ</strong>
                </div>

                <div id="inshrance_equal_layer" style="display: none;">
                    <strong id="equal_strong">インシュアランス失敗,,,さらに本選も負けてしまった</strong>
                </div>

                <div id="surrender_layer" style="display: none;">
                    <strong id="equal_strong">投降です、か。その判断が吉と出るか凶と出るか,,,</strong>
                </div>


        </div>
        </center>
    </div>

    <div id="result_layer" style="display: none;">
        <h1 id="contact-ttl">総合結果</h1>
        <input id="text_result" type="text">
    </div>
</body>
<!--メモ
    チーとぼたんの作成忘れずに
レイアウトの相談
音が鳴らなくなる理由
スタンドで関数は反応しているのに、３秒待ってくれない　どこ？
なぜかリセット関数よりも先に規則が解除されてします
ダブルの入力規則が遅い
ブラックジャックの時に入力規則が解除されてしまう
ヒットしたときなどのインシュアランスの入力規則
トランプの重ねで、段落が変わった時に少し画面外に行ってしまう
なぜか二つ目のベット金額表示テキストが上の位置とずれてしまう
通常での2ゲーム目にエラー


先生のやつ
自動で表示させるやつ（CID）、どんな関数を組んでいるの？
土っとゲームは画像はフリー？HBバーはどうやっているの
テーブルの装飾がどうしている
攻略サイトはどのようにしてレスポンシブ対応を実電させているのか

こうしたほうがいい
もっとお金の流れを分かりやすく-->

</html>